<div class="container card mt-4 pt-4 h-100">

    <div class="breadcrumb-container">

        <nav aria-label="breadcrumb">
            <ol class="breadcrumb breadcrumb-link">
                <li class="breadcrumb-item"><a [routerLink]="['/home']">Home</a></li>
                <li class="breadcrumb-item"><a [routerLink]="['/market-place']">MarketPlace</a></li>
                <li class="breadcrumb-item active" aria-current="page"><a [routerLink]="['/my-offers']">My Offers</a>
                </li>
            </ol>
        </nav>

    </div>

    <div class="d-flex gap-3 mt-4 mb-3">
        <div>
            <select class="form-select form-select fw-bold " [(ngModel)]="offerStatus">
                <option *ngFor="let list of offersFilterOptions" [value]="list.value"> {{list.label}}</option>
            </select>
        </div>
        <div *ngIf="offerStatus == 'All Active Listings'">
            <select class="form-select form-select fw-bold " [(ngModel)]="filterByProject" (change)="handleChange()">
                <option value="" disabled selected hidden>Filter by Project</option>
                <option *ngFor="let list of offersFilterOptions" [ngValue]="list.value"> {{list.label}}</option>

            </select>
        </div>

    </div>

    <table class="table">
        <thead>
            <tr>
                <th *ngFor="let item of offersColumns ; index as i " class="text-secondary "
                    [ngClass]="{'text-end': i > 0 }">{{item}}</th>
            </tr>
        </thead>
        <tbody class="my-listing-table-body" id="accordion">
            <ng-container *ngFor=" let offer of testMyOffer | paginate
            : {
                itemsPerPage: tableSize,
                currentPage: page,
                totalItems: count
              };
        let i = index">
                <tr class="text-end text-secondary">
                    <td class="text-start">{{offer.accountName}} / <span
                            class="pe-auto offer-td">{{offer.projectId}}</span></td>
                    <td class=""> {{offer.auctionEnd | date:'d MMM, y'}}</td>
                    <td>
                        {{offer.listedNMA}}
                    </td>
                    <td>{{offer.auctionType == 'Fix Bid' ? 'N/A' :
                        offer.minimumAsk |
                        currency:'':'':'4.2-2'}}</td>
                    <td>{{ offer.auctionType != 'Fix Bid' ? "N/A" : offer.buyNowPrice |
                        currency:'':'':'4.2-2'}}</td>
                    <td>{{offer.noOfBids}}</td>
                    <td>{{offer.auctionType.startsWith('Silent -') ? 'silent' : offer.highestBid |
                        currency:'':'':'4.2-2'}}</td>
                    <td id="heading{{i}}">
                        <span data-toggle="collapse" [attr.data-target]="'#collapse'+i" aria-expanded="false"
                            [attr.aria-controls]="'collapse'+i" class="offer-td collapsed pe-auto" title="Offer details"
                            [ngClass]="{'highest-offer':(offer.isHighestOffer  &&
                            !offer.auctionType.startsWith('Silent -') && offer.offerAmount) , 'not-highest-offer' :
                            (!offer.isHighestOffer && !offer.auctionType.startsWith('Silent -') && offer.offerAmount)  }">

                            {{!offer.offerAmount ? 'make offer':offer.offerAmount |
                            currency:'':'':'4.2-2'}}
                        </span>
                    </td>


                </tr>
                <tr id="collapse{{i}}" class=" collapse fade" [attr.aria-labelledby]="'heading'+i"
                    data-parent="#accordion">
                    <td colspan="8">

                        <div class="card-body">
                            <ul class="nav nav-tabs" id="myTab1" role="tablist">
                                <li class="nav-item my-listing-item" role="presentation">
                                    <button class="nav-link active " id="listingDetails-tab1" data-bs-toggle="tab"
                                        data-bs-target="#listingDetails1" type="button" role="tab"
                                        aria-controls="listingDetails1" aria-selected="true">Listing Details</button>
                                </li>
                                <li class="nav-item my-listing-item" role="presentation">
                                    <button class="nav-link " id="myOffers-tab1" data-bs-toggle="tab"
                                        data-bs-target="#myOffers1" type="button" role="tab" aria-controls="myOffers1"
                                        aria-selected="false">My Offer
                                    </button>
                                </li>

                            </ul>

                            <div class="tab-content" id="myTab1Content">
                                <div class="tab-pane fade show active " id="listingDetails1" role="tabpanel"
                                    aria-labelledby="listingDetails-tab1">

                                    <app-listing-details></app-listing-details>
                                </div>
                                <div class="tab-pane fade" id="myOffers1" role="tabpanel"
                                    aria-labelledby="myOffers-tab1">
                                    <app-my-offers></app-my-offers>
                                </div>


                            </div>
                        </div>
                    </td>
                </tr>
            </ng-container>

        </tbody>
    </table>
    <div class="d-flex justify-content-center">
        <pagination-controls previousLabel="Prev" nextLabel="Next" (pageChange)="onTableDataChange($event)">
        </pagination-controls>
    </div>

</div>